<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Empleados Oficios</h1>
    <select id="selectoficios"></select>
    <label for="">Incremento salarial:</label>
    <input type="number" id="incremento">
    <button id="botonincrementar">Incrementar salarios</button>
    <table id="tablaempleados" border="1">
        <thead>
            <th>Apellido</th>
            <th>Oficio</th>
            <th>Salario</th>
        </thead>
        <tbody></tbody>
    </table>
    <script src="js/jquery-3.7.1.js"></script>
    <script>
        $(document).ready(function(){
            loadOficios();
        })

        function loadOficios(){
            $.getJSON("https://apiempleadosaction.azurewebsites.net/api/Empleados/GetOficios/oficios", function(data){
                $.each(data, function(key, value){
                    let option = $("<option>", {"text": value, "value": value})
                    $("#selectoficios").append(option);
                })
            })
            $("#selectoficios").change(function(){
                let oficio = $(this).val();
                $.getJSON("https://apiempleadosaction.azurewebsites.net/api/Empleados/GetEmpleadosOficio/empleadosoficio/" + oficio, function(data){
                    let html = "";
                    $.each(data, function(index, empleado){
                        let apellido = empleado.apellido;
                        let oficio = empleado.oficio;
                        let salario = empleado.salario;
                        html += "<tr>";
                        html += "<td>" + apellido + "</td>";
                        html += "<td>" + oficio + "</td>";
                        html += "<td>" + salario + "</td>";
                        html += "</tr>";
                    })
                    $("#tablaempleados tbody").html(html);
                })
                $("#botonincrementar").click(function(){
                    let incremento = parseInt($("#incremento").val());
                    console.log(incremento);
                    $.ajax({
                        url: "https://apiempleadosaction.azurewebsites.net/api/Empleados/IncrementarSalarioOficios/" + oficio + "/" + incremento,
                        type: "PUT",
                        success: function(data){
                            console.log("Incrementado");
                            loadOficios();
                        }
                    })
                })
            })
        }


    </script>
</body>
</html>